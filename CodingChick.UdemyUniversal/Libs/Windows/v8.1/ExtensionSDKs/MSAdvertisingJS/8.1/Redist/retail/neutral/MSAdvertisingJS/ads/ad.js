/*!
  Copyright (C) Microsoft. All rights reserved.
  This library is supported for use in Windows Store apps only.
*/
(function(n){"use strict";n.Namespace.define("MicrosoftNSJS.Advertising",{AdControl:n.Class.define(function(t,i){try{if(t===null||typeof t=="undefined")t=document.createElement("div");else if(this._isElementAllowed(t))t=t;else return;t.winControl=this;this._adsGlobalEventManager=new MicrosoftNSJS.Advertising.AdGlobalEventManager;this._adSettingsControl=new MicrosoftNSJS.Advertising.AdSettingsControl({flyoutHtmlTemplateURI:"ms-appx:///MSAdvertisingJS/ads/MSASettingsPanel.html",resourceLoaderURI:"MicrosoftAdvertising/UIStrings"});try{this._rendererOptions=new MicrosoftAdvertising.Shared.WinRT.RendererOptions}catch(u){}this._rendererOptionsUsedInRequest=null;this._globalAdEngagedHandler=null;this._globalAdDisengagedHandler=null;this._ad=null;this._adIFrame=null;this._expandedIFrame=null;this._iFrameToRemove=null;this._applicationId="";this._adUnitId="";this._currentAdHeight=null;this._currentAdWidth=null;this._defaultStateSize={};this._isDisposed=!1;this._errorReportCount=0;this._expandProperties=null;this._isAutoRefreshEnabled=!0;this._isExpanded=!1;this._isUserEngaged=!1;this._isSuspended=!1;this._ormmaState=this._ORMMA_STATE_DEFAULT;this._placement=null;this._previousOrmmaState="";this._refreshPeriodSeconds=60;this._refreshTimerId=null;this._requestInProgress=!1;this._timeAtLastRotation=null;this._currentCloseBandHeight=this._RESERVED_CLOSE_BAND_HEIGHT;this._accelerometer={device:null,tiltHandlers:[],shakeHandlers:[]};this._lastCoords={x:0,y:0,z:0};this._viewableChangedTimer=null;this._hasViewablility=!1;this._viewableCheckPeriodMs=500;this._orientationChangedHandler=null;this._fadeOptions={timer:{linear:" cubic-bezier(0,0,1,1)"},fadeInTimeS:.7,fadeOutTimeS:.7};this._sensorOptions={accelerometer:{reportIntervalMS:50}};this._adInstanceState=null;this._onAdRefreshedInternal=null;this._onAdRefreshed=null;this._onBeforeAdRender=null;this._onErrorOccurred=null;this._onEngagedChanged=null;this._onPointerDown=null;this._onPointerUp=null;this._onPointerMove=null;this._onMouseWheel=null;this._onManipulationStateChanged=null;this._preventDefaultAppHandlers=!1;this._applicationEventsMask=0;t.style.breakInside="avoid";t.style.overflow="hidden";t.style.position===""&&(t.style.position="relative");n.UI.setOptions(this,i);this._setElement(t);this._setupEvents();var r=this;setImmediate(function(){r._requestInProgress||r._ad!==null||r._refreshInternal()})}catch(u){return}},{_MSG_TYPE_ADPARAMS:"adParams",_MSG_TYPE_PRMPARAMS:"prmParams",_MSG_TYPE_APPPARAMS:"appParams",_MSG_TYPE_INIT:"init",_MSG_TYPE_ORMMA_START:"ormmaStart",_MSG_TYPE_SCRIPT:"script",_MSG_TYPE_SETMAXSIZE:"setMaxSize",_MSG_TYPE_SETSCREENSIZE:"setScreenSize",_MSG_TYPE_SETSIZE:"setSize",_MSG_TYPE_SETSTATE:"setState",_MSG_TYPE_SETID:"setId",_MSG_TYPE_FIRESHAKE:"fireShake",_MSG_TYPE_UPDATETILTCOORDS:"updateTiltCoords",_MSG_TYPE_UPDATEORIENTATION:"updateOrienation",_MSG_TYPE_SETNETWORK:"setNetwork",_MSG_TYPE_VIEWABLECHANGE:"viewableChange",_MSG_TYPE_SETLOCALE:"setLocale",_MSG_TYPE_SETSDKINFO:"setSdkInfo",_MSG_TYPE_SETCAPABILITY:"setCapability",_MSG_TYPE_SETADINSTANCESTATE:"setAdInstanceState",_MSG_TYPE_WIREAPPEVENTS:"wireAppEvents",_MSG_TYPE_SETFOCUS:"setFocus",_MSG_TYPE_INITIALIZED:"adInitialized",_MSG_TYPE_ADRENDERED:"rendered",_MSG_TYPE_OPEN:"web",_MSG_TYPE_EXPAND:"expand",_MSG_TYPE_CLOSE:"close",_MSG_TYPE_RESIZE:"resize",_MSG_TYPE_HIDE:"hide",_MSG_TYPE_SHOW:"show",_MSG_TYPE_SETEXPANDPROPERTIES:"setexpandproperties",_MSG_TYPE_SETUSERENGAGED:"setuserengaged",_MSG_TYPE_TILT:"tilt",_MSG_TYPE_SHAKE:"shake",_MSG_TYPE_LISTENER:"listener",_MSG_TYPE_VALUESTART:"start",_MSG_TYPE_VALUESTOP:"stop",_MSG_TYPE_GETTILT:"gettilt",_MSG_TYPE_GETORIENTATION:"getorientation",_MSG_TYPE_REFRESH:"refresh",_MSG_TYPE_REQUEST:"request",_MSG_TYPE_STOREADINSTANCESTATE:"storeadinstancestate",_MSG_TYPE_ONPOINTERDOWN:"MSPointerDown",_MSG_TYPE_ONPOINTERUP:"MSPointerUp",_MSG_TYPE_USECUSTOMCLOSE:"usecustomclose",_MSG_TYPE_ONMOUSEWHEEL:"MSMouseWheel",_MSG_TYPE_ONPOINTERMOVE:"MSPointerMove",_MSG_TYPE_ONMANIPSTATECHANGED:"MSManipulationStateChanged",_MSG_TYPE_ERROR:"error",_ORMMA_STATE_DEFAULT:"default",_ORMMA_STATE_EXPANDED:"expanded",_ORMMA_STATE_HIDDEN:"hidden",_ORMMA_STATE_RESIZED:"resized",_ORMMA_STATE_SUSPENDED:"suspended",_ORMMA_NETWORK_OFFLINE:"offline",_ORMMA_NETWORK_WIFI:"wifi",_ORMMA_NETWORK_CELL:"cell",_ORMMA_NETWORK_UNKNOWN:"unknown",_ORMMA_RESPONSE_IGNORE:"ignore",_ORMMA_RESPONSE_PROXY:"proxy",_HTTP_HEADER_CACHE_CONTROL:"cache-control",_HTTP_HEADER_VALUE_CACHE_CONTROL_NO_CACHE:"no-cache",_RESERVED_CLOSE_BAND_HEIGHT:100,_MIN_AD_REFRESH_INTERVAL_IN_MILLISECONDS_METERED:6e4,_MIN_AD_REFRESH_INTERVAL_IN_MILLISECONDS_UNMETERED:3e4,_MAX_ERROR_REPORT:20,_MAX_ERROR_REPORT_MESSAGE:"error reporting maximum reached, no more errors will be reported",_MAX_URL_LENGTH:2048,_ERROR_ENUM:{Unknown:"Unknown",NoAdAvailable:"NoAdAvailable",NetworkConnectionFailure:"NetworkConnectionFailure",ClientConfiguration:"ClientConfiguration",ServerSideError:"ServerSideError",InvalidServerResponse:"InvalidServerResponse",RefreshNotAllowed:"RefreshNotAllowed",Other:"Other"},_EVENT_TYPE_ENUM:{All:-1,PointerDown:1,PointerUp:2,PointerMove:4,MouseWheel:16,ManipulationStateChanged:32},onAdRefreshed:{get:function(){return this._onAdRefreshed},set:function(n){(typeof n=="function"||n===null||typeof n=="undefined")&&(this._onAdRefreshed=n)}},onBeforeAdRender:{get:function(){return this._onBeforeAdRender},set:function(n){(typeof n=="function"||n===null||typeof n=="undefined")&&(this._onBeforeAdRender=n)}},onErrorOccurred:{get:function(){return this._onErrorOccurred},set:function(n){(typeof n=="function"||n===null||typeof n=="undefined")&&(this._onErrorOccurred=n)}},onEngagedChanged:{get:function(){return this._onEngagedChanged},set:function(n){(typeof n=="function"||n===null||typeof n=="undefined")&&(this._onEngagedChanged=n)}},onPointerDown:{get:function(){return this._onPointerDown},set:function(n){(typeof n=="function"||n===null||typeof n=="undefined")&&(this._onPointerDown=n,typeof n=="function"?(this._addApplicationEventType(this._EVENT_TYPE_ENUM.PointerDown),this._updateApplicationEvents()):(this._removeApplicationEventType(this._EVENT_TYPE_ENUM.PointerDown),this._updateApplicationEvents()))}},onPointerUp:{get:function(){return this._onPointerUp},set:function(n){(typeof n=="function"||n===null||typeof n=="undefined")&&(this._onPointerUp=n,typeof n=="function"?this._addApplicationEventType(this._EVENT_TYPE_ENUM.PointerUp):this._removeApplicationEventType(this._EVENT_TYPE_ENUM.PointerUp),this._updateApplicationEvents())}},onMouseWheel:{get:function(){return this._onMouseWheel},set:function(n){(typeof n=="function"||n===null||typeof n=="undefined")&&(this._onMouseWheel=n,typeof n=="function"?this._addApplicationEventType(this._EVENT_TYPE_ENUM.MouseWheel):this._removeApplicationEventType(this._EVENT_TYPE_ENUM.MouseWheel),this._updateApplicationEvents())}},onPointerMove:{get:function(){return this._onPointerMove},set:function(n){(typeof n=="function"||n===null||typeof n=="undefined")&&(this._onPointerMove=n,typeof n=="function"?this._addApplicationEventType(this._EVENT_TYPE_ENUM.PointerMove):this._removeApplicationEventType(this._EVENT_TYPE_ENUM.PointerMove),this._updateApplicationEvents())}},onManipulationStateChanged:{get:function(){return this._onManipulationStateChanged},set:function(n){(typeof n=="function"||n===null||typeof n=="undefined")&&(this._onManipulationStateChanged=n,typeof n=="function"?this._addApplicationEventType(this._EVENT_TYPE_ENUM.ManipulationStateChanged):this._removeApplicationEventType(this._EVENT_TYPE_ENUM.ManipulationStateChanged),this._updateApplicationEvents())}},preventDefaultApplicationEvents:{get:function(){return this._preventDefaultAppHandlers},set:function(n){this._preventDefaultAppHandlers!==n&&(this._preventDefaultAppHandlers=n)}},applicationId:{get:function(){return this._applicationId},set:function(n){this._applicationId!==n&&(this._applicationId=n)}},adUnitId:{get:function(){return this._adUnitId},set:function(n){this._adUnitId!==n&&(this._adUnitId=n)}},isAutoRefreshEnabled:{get:function(){return this._isAutoRefreshEnabled},set:function(n){this._isAutoRefreshEnabled!==n&&(this._isAutoRefreshEnabled=n,this._isAutoRefreshEnabled?this._scheduleRefresh():this._unscheduleRefresh())}},isEngaged:{get:function(){return this._isExpanded||this._isUserEngaged}},isSuspended:{get:function(){return this._isSuspended}},latitude:{get:function(){return this._latitude},set:function(n){this._latitude=typeof n=="string"?parseFloat(n):n}},longitude:{get:function(){return this._longitude},set:function(n){this._longitude=typeof n=="string"?parseFloat(n):n}},element:{get:function(){return this._domElement}},addAdTag:function(n,t){if(typeof n=="string"&&typeof t=="string")try{this._rendererOptions.addRendererOption(n,t)}catch(i){this._fireErrorOccurred("could not add renderer option or value",this._ERROR_ENUM.Other)}else this._fireErrorOccurred("could not add renderer option or value as they were not strings",this._ERROR_ENUM.Other)},removeAdTag:function(n){if(typeof n=="string")try{this._rendererOptions.removeRendererOption(n)}catch(t){this._fireErrorOccurred("could not remove renderer option or value",this._ERROR_ENUM.Other)}},refresh:function(){if(this._isAutoRefreshEnabled){this._fireErrorOccurred("refresh() may not be called when auto-refresh is enabled (isAutoRefreshEnabled=true)",this._ERROR_ENUM.RefreshNotAllowed);return}this._checkIfRefreshIntervalMetAndRaiseError()&&this._refreshInternal()},suspend:function(){this._isExpanded&&this._closePopup();this._unscheduleRefresh();this._ormmaState!==this._ORMMA_STATE_SUSPENDED&&this._setState(this._ORMMA_STATE_SUSPENDED);this._isSuspended=!0},resume:function(){this._scheduleRefresh();this._ormmaState===this._ORMMA_STATE_SUSPENDED&&(typeof this._previousOrmmaState=="undefined"||this._previousOrmmaState===null?this._setState(this._ORMMA_STATE_DEFAULT):this._setState(this._previousOrmmaState));this._isSuspended=!1},dispose:function(){try{this._expandedIFrame!==null&&this._closePopup();typeof this._resizeHandler=="function"&&(window.removeEventListener("resize",this._resizeHandler),this._resizeHandler=null);typeof this._domNodeRemovedHandler=="function"&&(this._domElement!==null&&this._domElement.removeEventListener("DOMNodeRemoved",this._domNodeRemovedHandler),this._domNodeRemovedHandler=null);this._adIFrame!==null&&(this._removeIFrame(this._adIFrame),this._adIFrame=null);this._disposeAccelerometer();this._stopOrientationMonitoring();this._stopViewableChangeMonitoring();this._onAdRefreshedInternal=null;this._onAdRefreshed=null;this._onBeforeAdRender=null;this._onErrorOccurred=null;this._onEngagedChanged=null;this._onPointerDown=null;this._onPointerUp=null;this._onMouseWheel=null;this._onPointerMove=null;this._onManipulationStateChanged=null;this._onRemove();this._applicationEventsMask=0;this._preventDefaultAppHandlers=!1;this._adsGlobalEventManager.removeEventListener(MicrosoftNSJS.Advertising.AdGlobalEventManager.EVENT_TYPE.AD_ENGAGED,this._globalAdEngagedHandler);this._adsGlobalEventManager.removeEventListener(MicrosoftNSJS.Advertising.AdGlobalEventManager.EVENT_TYPE.AD_DISENGAGED,this._globalAdDisengagedHandler);this._adsGlobalEventManager.dispose();this._domElement!==null&&(this._domElement.winControl=null,this._domElement.onresize=null,this._domElement=null);this._rendererOptionsUsedInRequest=null;this._isDisposed=!0}catch(n){}},_checkIfRefreshIntervalMetAndRaiseError:function(){var n=!1,t=this._MIN_AD_REFRESH_INTERVAL_IN_MILLISECONDS_UNMETERED,i,r,u;if(this._timeAtLastRotation!==null)try{i=Windows.Networking.Connectivity.NetworkInformation.getInternetConnectionProfile();i!==null&&(r=i.getConnectionCost(),u=r.NetworkCostType===Windows.Networking.Connectivity.NetworkCostType.fixed||r.NetworkCostType===Windows.Networking.Connectivity.NetworkCostType.variable,t=u?this._MIN_AD_REFRESH_INTERVAL_IN_MILLISECONDS_METERED:this._MIN_AD_REFRESH_INTERVAL_IN_MILLISECONDS_UNMETERED)}catch(f){}else return this._timeAtLastRotation=new Date,!0;return n=new Date-this._timeAtLastRotation>t,n||this._fireErrorOccurred("refresh() may not be called more than once every "+t/1e3+" seconds.",this._ERROR_ENUM.RefreshNotAllowed),n},_log:function(){},_getSdkInfo:function(){try{var n=MicrosoftAdvertising.Shared.WinRT.SdkInfoProvider.getSdkInfo();return{sdkVersion:n.sdkVersion,client:n.client,runtimeType:n.runtimeType}}catch(t){return{}}},_fadeIn:function(n,t){try{typeof n=="object"&&n!==null?(n.style.visibility="inherit",n.style.transition="opacity "+this._fadeOptions.fadeInTimeS+"s"+this._fadeOptions.timer.linear,n.style.opacity=1,typeof t=="function"&&window.setTimeout(function(){t(!0)},this._fadeOptions.fadeInTimeS*1e3)):typeof t=="function"&&t(!1)}catch(i){}},_fadeOut:function(n,t){try{typeof n=="object"&&n!==null?(n.style.transition="opacity "+this._fadeOptions.fadeInTimeS+"s"+this._fadeOptions.timer.linear,n.style.opacity=0,typeof t=="function"&&window.setTimeout(function(){t(!0)},this._fadeOptions.fadeOutTimeS*1e3)):typeof t=="function"&&t(!1)}catch(i){}},_refreshInternal:function(){if(this._requestInProgress){this._fireErrorOccurred("refresh triggered but request is already in progress",this._ERROR_ENUM.RefreshNotAllowed);return}this._requestInProgress=!0;try{if(Windows.ApplicationModel.DesignMode.designModeEnabled){this._requestInProgress=!1;return}}catch(t){}if(window!==top){this._requestInProgress=!1;this._fireErrorOccurred("ad control may not be loaded in an iframe",this._ERROR_ENUM.Other);return}if(this._domElement===null||this._domElement.offsetWidth===0||this._domElement.offsetHeight===0){this._requestInProgress=!1;return}if(this._isExpanded){this._requestInProgress=!1;return}if(this._isSuspended){this._requestInProgress=!1;this._fireErrorOccurred("cannot refresh when suspended",this._ERROR_ENUM.RefreshNotAllowed);return}if(this._isUserEngaged){this._requestInProgress=!1;this._scheduleRefresh();return}if(typeof window._msAdEngaged!="undefined"&&window._msAdEngaged){this._requestInProgress=!1;this._scheduleRefresh();return}if(!this._validateParameters()){this._requestInProgress=!1;this._scheduleRefresh();return}if(this._adIFrame!==null&&(document.hidden||!this._isOnScreen())){this._requestInProgress=!1;this._fireErrorOccurred("refresh not performed because ad is not on screen",this._ERROR_ENUM.RefreshNotAllowed);this._scheduleRefresh();return}if(this._placement===null)try{this._placement=new MicrosoftAdvertising.Shared.WinRT.AdPlacement}catch(t){this._requestInProgress=!1;this._fireErrorOccurred("could not initialize AdPlacement",this._ERROR_ENUM.Other);return}if(this._placement.applicationId=this._applicationId,this._placement.adUnitId=this._adUnitId,this._placement.latitude=this.latitude,this._placement.longitude=this.longitude,this._placement.width=this._domElement.offsetWidth,this._placement.height=this._domElement.offsetHeight,this._rendererOptions!==null&&typeof this._rendererOptions!="undefined"){try{this._rendererOptionsUsedInRequest=this._rendererOptions.getOptionsJson()}catch(i){this._log("error: could not get renderer options as json")}this._placement.adTags=this._rendererOptions.getOptions()}try{var n=this;this._placement.getAdAsync().done(function(t){if(t!==null)n._adRefreshedCallback(t);else if(!n._isDisposed&&n._placement!==null&&typeof n._placement!="undefined"){var i=n._placement.lastError;n._errorOccurredCallback(i)}},function(){if(!n._isDisposed&&n._placement!==null&&typeof n._placement!="undefined"){var t=n._placement.lastError;n._errorOccurredCallback(t)}});this._timeAtLastRotation=new Date}catch(t){n._errorOccurredCallback({errorMessage:t.message,errorCode:this._ERROR_ENUM.Other})}},_networkInfo:function(){try{return Windows.Networking.Connectivity.NetworkInformation}catch(n){}}(),_networkChangedEventHandler:function(){},_isViewable:function(){var n,t;if(this._adIFrame===null)return!1;n=0;try{t=getComputedStyle(this._adIFrame,null);typeof t!="undefined"&&t!==null&&typeof t.opacity=="string"&&(n=parseInt(t.opacity,10),isNaN(n)&&(n=0))}catch(i){return!1}return this._isOnScreen()&&n===1},_isOnScreen:function(){var t,n,i,r;if(this._domElement===null||this._domElement.offsetWidth===0||this._domElement.offsetHeight===0||this._isElementHidden()||this._adIFrame.offsetWidth===0||this._adIFrame.offsetHeight===0)return!1;t=.4;n={};try{n=this._domElement.getBoundingClientRect()}catch(u){return!1}return i=this._domElement.offsetWidth*t,r=this._domElement.offsetHeight*t,n.left>=-i&&n.top>=-r&&n.right<document.documentElement.offsetWidth+i&&n.bottom<document.documentElement.offsetHeight+r},_isElementHidden:function(){for(var n=this._domElement,t;n!==null&&typeof n=="object"&&n.nodeName!=="BODY";){if(t=typeof n.style!="undefined"?n.style.visibility:"",t==="hidden"||t==="collapse")return!0;if(t==="visible")break;else n=n.parentNode}return!1},_errorOccurredCallback:function(n){this._isDisposed||(typeof n!="object"||n===null?this._fireErrorOccurred("Other",this._ERROR_ENUM.Other):this._fireErrorOccurred(n.errorMessage,n.errorCode),this._currentAdHeight=null,this._currentAdWidth=null,this._requestInProgress=!1,this._scheduleRefresh())},_adRefreshedCallback:function(n){this._isDisposed||(n!==null&&this._onAdReceived(n),this._requestInProgress=!1,this._updateApplicationEvents(),this._scheduleRefresh())},_addApplicationEventType:function(n){n!==null&&typeof n=="number"&&(n&this._applicationEventsMask)==0&&(this._applicationEventsMask=this._applicationEventsMask|n)},_removeApplicationEventType:function(n){var t;n!==null&&typeof n=="number"&&(n&this._applicationEventsMask)!=0&&(t=n^-1,this._applicationEventsMask=this._applicationEventsMask&t)},_updateApplicationEvents:function(){if(this._isDisposed!==!0&&this._requestInProgress!==!0)try{this._adIFrame!==null&&typeof this._adIFrame!="undefined"&&this._ormmaState!==this._ORMMA_STATE_EXPANDED&&this._sendMessageToAdContainer(this._adIFrame,this._MSG_TYPE_WIREAPPEVENTS+":"+JSON.stringify({events:this._applicationEventsMask,preventDefault:this.preventDefaultApplicationEvents}))}catch(n){return}},_onAdReceived:function(n){if(typeof n!="undefined"&&n!==null){this._resetAdControl();this._ad=n;this._currentAdHeight=this._placement.height;this._currentAdWidth=this._placement.width;typeof this._iFrameToRemove!="undefined"&&this._iFrameToRemove!==null&&(this._removeIFrame(this.iFrameToRemove),this._iFrameToRemove=null);this._iFrameToRemove=this._adIFrame;try{var f=this._ad.rendererUrl,e=this._ad.adParameters,o=this._ad.prmParameters}catch(r){r!==null&&typeof r=="object"&&this._fireErrorOccurred(r.message,this._ERROR_ENUM.Other);return}var t=this,u=function(){var n=t._createMainFrame();if(n===null||typeof n!="object"){t._fireErrorOccurred("could not create iframe",t._ERROR_ENUM.Other);return}t._adIFrame=n;t._onAdRefreshedInternal=function(){typeof t._iFrameToRemove=="object"&&t._iFrameToRemove!==null?t._fadeIn(n,function(){t._removeIFrame(t._iFrameToRemove);t._iFrameToRemove=null}):t._showIFrame(n);t._onAdRefreshedInternal=null};t._loadAdInFrame(n,f,e,o)},i=this._fireBeforeAdRender();typeof i=="object"&&i!==null&&typeof i.then=="function"?i.then(u):u()}},_resetAdControl:function(){this._adInstanceState=null;this._disposeAccelerometer();this._stopOrientationMonitoring();this._stopViewableChangeMonitoring();this._setUseCustomClose(!1);this._errorReportCount=0;this._expandProperties=null;this._ormmaState=this._ORMMA_STATE_DEFAULT;this._previousOrmmaState="";this._currentCloseBandHeight=this._RESERVED_CLOSE_BAND_HEIGHT},_showIFrame:function(n){typeof n=="object"&&n!==null&&(n.style.opacity=1,n.style.visibility="inherit")},_removeIFrame:function(n){(n===null||typeof n=="undefined")&&(n=this._adIFrame);this._removeFromParent(n)},_removeFromParent:function(n){try{if(n!==null&&typeof n=="object"){var t=n.parentNode;t!==null&&typeof t=="object"&&t.removeChild(n)}}catch(i){}},_createMainFrame:function(){return this._createIFrame(this._domElement.id+"_webFrame_"+ +new Date,this._domElement.offsetWidth,this._domElement.offsetHeight,this._domElement,this._ORMMA_STATE_DEFAULT)},_initializeOrmma:function(n,t,i,r){var f={height:i,width:t},o="undefined",u;try{o=Windows.Globalization.ApplicationLanguages.languages[0]}catch(e){this._log("locale init error: "+(typeof e=="object"?e.message:e))}r===this._ORMMA_STATE_DEFAULT&&(this._defaultStateSize=f);this._sendMessageToAdContainer(n,this._MSG_TYPE_SETSIZE+":"+JSON.stringify(f));this._sendMessageToAdContainer(n,this._MSG_TYPE_SETMAXSIZE+":"+JSON.stringify(f));this._setOrmmaScreenSize(n);this._sendMessageToAdContainer(n,this._MSG_TYPE_SETSTATE+":"+r);this._sendMessageToAdContainer(n,this._MSG_TYPE_SETLOCALE+":"+o);this._sendMessageToAdContainer(n,this._MSG_TYPE_SETNETWORK+":"+this._getNetworkState());this._sendMessageToAdContainer(n,this._MSG_TYPE_SETSDKINFO+":"+JSON.stringify(this._getSdkInfo()));u=!1;try{u=Windows.Devices.Sensors.Accelerometer.getDefault()!==null}catch(e){}this._sendMessageToAdContainer(n,this._MSG_TYPE_SETCAPABILITY+":"+JSON.stringify({capability:"tilt",value:u}));this._sendMessageToAdContainer(n,this._MSG_TYPE_SETCAPABILITY+":"+JSON.stringify({capability:"shake",value:u}));this._sendMessageToAdContainer(n,this._MSG_TYPE_ORMMA_START)},_createIFrame:function(n,t,i,r,u){try{var f=document.createElement("iframe");return f.src="ms-appx-web:///MSAdvertisingJS/ads/bootstrap.html",f.width=t+"px",f.height=i+"px",f.frameBorder="0px",f.marginwidth="0px",f.marginheight="0px",f.id=n,f.scrolling="no",f.style.position="absolute",f.style.visibility="hidden",f.style.backgroundColor="transparent",f.style.opacity=0,r.appendChild(f),this._sendMessageToAdContainer(f,this._MSG_TYPE_SETID+":"+this._domElement.id),this._initializeOrmma(f,t,i,u),f}catch(e){return}},_setElement:function(n){(n.id===null||n.id==="")&&(n.id=this._generateUniqueId());this._domElement=n},_generateUniqueId:function(){var n=null,t=null;do n="ad"+Math.floor(Math.random()*1e4),t=document.getElementById(n);while(t!==null);return n},_loadAdInFrame:function(n,t,i,r){if(this._renderContent===null||typeof this._renderContent=="undefined"){if(this._getNetworkState()===this._ORMMA_NETWORK_OFFLINE){this._removeIFrame(n);this._fireErrorOccurred("no network is available",this._ERROR_ENUM.NetworkConnectionFailure);return}var u=new XMLHttpRequest,f=this;u.onreadystatechange=function(){u.readyState===XMLHttpRequest.DONE&&(u.status===200?(f._rendererContent=u.responseText,f._loadAdInFrameB(n,f._rendererContent,i,r)):(f._removeIFrame(n),f._fireErrorOccurred("error loading ad renderer: code "+u.status,f._ERROR_ENUM.NetworkConnectionFailure)))};u.open("GET",t,!0);u.timeout=1e4;try{u.send(null)}catch(e){this._removeIFrame(n);this._fireErrorOccurred("http request error: "+e.message,this._ERROR_ENUM.NetworkConnectionFailure);return}}else this._loadAdInFrameB(n,this._rendererContent,i,r)},_loadAdInFrameB:function(n,t,i,r){this._rendererParams=i;this._prmParams=r;this._sendAdDataToAdContainer(n,t,i,r)},_sendMessageToAdContainer:function(n,t){if(n!==null&&n!==undefined){var i=n.contentWindow,u="ms-appx-web://"+document.location.host,r=this;setImmediate(function(){if(i&&!r._isDisposed)try{i.postMessage(t,u)}catch(n){n!==null&&typeof n=="object"&&r._log("postMessage error"+(typeof n!="undefined"?": "+n.message:""))}})}},_sendMessageToAllAdContainers:function(n){try{this._sendMessageToAdContainer(this._adIFrame,n);this._sendMessageToAdContainer(this._expandedIFrame,n)}catch(t){}},_sendAdDataToAdContainer:function(n,t,i,r){try{typeof i=="string"&&i!==""&&this._sendMessageToAdContainer(n,this._MSG_TYPE_ADPARAMS+":"+i);typeof r=="string"&&r!==""&&this._sendMessageToAdContainer(n,this._MSG_TYPE_PRMPARAMS+":"+r);var u=this._rendererOptionsUsedInRequest;typeof u=="string"&&u!==""&&this._sendMessageToAdContainer(n,this._MSG_TYPE_APPPARAMS+":"+u);this._sendMessageToAdContainer(n,this._MSG_TYPE_SCRIPT+":"+t);this._sendMessageToAdContainer(n,this._MSG_TYPE_INIT)}catch(f){}},_fireErrorOccurred:function(n,t){this._log(n+" ("+t+")");typeof this._onErrorOccurred=="function"&&this._onErrorOccurred(this,{errorMessage:n,errorCode:t})},_firePointerDown:function(n){typeof this._onPointerDown=="function"&&this._onPointerDown(this,n)},_firePointerUp:function(){typeof this._onPointerUp=="function"&&this._onPointerUp(this)},_fireEngagedChanged:function(){typeof this._onEngagedChanged=="function"&&this._onEngagedChanged(this)},_fireMouseWheel:function(n){typeof this._onMouseWheel=="function"&&this._onMouseWheel(this,n)},_firePointerMove:function(n){typeof this._onPointerMove=="function"&&this._onPointerMove(this,n)},_fireManipulationStateChanged:function(n){typeof this._onManipulationStateChanged=="function"&&this._onManipulationStateChanged(this,n)},_fireAdRefreshed:function(){this._isExpanded||(typeof this._onAdRefreshedInternal=="function"&&this._onAdRefreshedInternal(),typeof this._onAdRefreshed=="function"&&this._onAdRefreshed(this))},_fireBeforeAdRender:function(){return typeof this._onBeforeAdRender=="function"?this._onBeforeAdRender(this):null},_receiveMessage:function(n){var u,f,e,o,t,i,r,c,s,l,h;if(n.origin==="ms-appx-web://"+document.location.host&&(u=n.data,f=u.indexOf(":"),!(f<0))&&(e=u.substr(0,f),e!=="null")&&(u=u.substr(f+1),o=document.getElementById(e),o!==null)&&(t=o.winControl,t!==null&&typeof t=="object"&&!t._isDisposed))if(i=null,r=null,f=u.indexOf(":"),f<0?i=u:(i=u.substr(0,f),r=u.substr(f+1)),i===t._MSG_TYPE_EXPAND)try{c=JSON.parse(r);t._ormmaState===t._ORMMA_STATE_DEFAULT||t._ormmaState===t._ORMMA_STATE_RESIZED?t._expand(c.url):t._reportError("expand","state is not default or resized, current state is:"+t._ormmaState)}catch(a){t._reportError(t._MSG_TYPE_EXPAND,"unable to parse expand properties as json")}else if(i===t._MSG_TYPE_CLOSE)t._ormmaState===t._ORMMA_STATE_EXPANDED?t._closePopup():t._ormmaState===t._ORMMA_STATE_DEFAULT?t._resize(0,0,t._ORMMA_STATE_HIDDEN):t._ormmaState===t._ORMMA_STATE_RESIZED?t._resize(t._defaultStateSize.width,t._defaultStateSize.height,t._ORMMA_STATE_DEFAULT):t._reportError("close","state is not expanded, default or resized, current state is:"+t._ormmaState);else if(i===t._MSG_TYPE_SETEXPANDPROPERTIES)t._updateExpandProperties(r);else if(i===t._MSG_TYPE_SETUSERENGAGED)t._processSetUserEngaged(r);else if(i===t._MSG_TYPE_ADRENDERED)t._fireAdRefreshed();else if(i!==t._MSG_TYPE_INITIALIZED)if(i===t._MSG_TYPE_TILT)t._processTiltMessage(r);else if(i===t._MSG_TYPE_SHAKE)t._processShakeMessage(r);else if(i===t._MSG_TYPE_GETORIENTATION)t._processGetOrientationMessage(r);else if(i===t._MSG_TYPE_ERROR)t._removeIFrame(),t._fireErrorOccurred(r,t._ERROR_ENUM.Other);else if(i===t._MSG_TYPE_RESIZE)t._ormmaState===t._ORMMA_STATE_DEFAULT?(s=JSON.parse(r),t._resize(s.width,s.height,t._ORMMA_STATE_RESIZED)):t._reportError("resize","state is not default, current state is:"+t._ormmaState);else if(i===t._MSG_TYPE_HIDE)t._ormmaState===t._ORMMA_STATE_DEFAULT?t._resize(0,0,t._ORMMA_STATE_HIDDEN):t._reportError("hide","state is not default, current state is:"+t._ormmaState);else if(i===t._MSG_TYPE_SHOW)t._ormmaState===t._ORMMA_STATE_HIDDEN?t._resize(t._defaultStateSize.width,t._defaultStateSize.height,t._ORMMA_STATE_DEFAULT):t._reportError("show","state is not hidden, current state is:"+t._ormmaState);else if(i===t._MSG_TYPE_OPEN)if(l=JSON.parse(r),h=t._getUri(l),h!==null)try{Windows.System.Launcher.launchUriAsync(h)}catch(a){t._reportError("open","unable to open URL")}else t._reportError("open","parameters are not valid");else i===t._MSG_TYPE_REQUEST?t._request(JSON.parse(r)):i===t._MSG_TYPE_VIEWABLECHANGE?t._processViewableChangeMessage(r):i===t._MSG_TYPE_STOREADINSTANCESTATE?t._storeAdInstanceState(r):i===t._MSG_TYPE_ONPOINTERDOWN?t._firePointerDown(JSON.parse(r)):i===t._MSG_TYPE_ONPOINTERUP?t._firePointerUp():i===t._MSG_TYPE_USECUSTOMCLOSE?t._setUseCustomClose(JSON.parse(r)):i===t._MSG_TYPE_ONMOUSEWHEEL?t._fireMouseWheel(JSON.parse(r)):i===t._MSG_TYPE_ONPOINTERMOVE?t._firePointerMove(JSON.parse(r)):i===t._MSG_TYPE_ONMANIPSTATECHANGED?t._fireManipulationStateChanged(JSON.parse(r)):t._reportError("unknown","unknown action")},_reportError:function(n,t){this._errorReportCount<this._MAX_ERROR_REPORT&&(this._errorReportCount++,t=this._errorReportCount>=this._MAX_ERROR_REPORT?this._MAX_ERROR_REPORT_MESSAGE:t,this._sendMessageToAllAdContainers(this._MSG_TYPE_ERROR+":"+JSON.stringify({action:n,message:t})))},_setupEvents:function(){try{window.addEventListener("message",this._receiveMessage);var n=this;this._domElement.onresize=function(){n._onResize()};this._resizeHandler=this._onDocumentResize.bind(this);window.addEventListener("resize",this._resizeHandler);this._domNodeRemovedHandler=function(t){t.target===n._domElement&&n._onRemove()};this._domElement.addEventListener("DOMNodeRemoved",this._domNodeRemovedHandler);this._networkChangedEventHandler=function(){n._sendMessageToAllAdContainers(n._MSG_TYPE_SETNETWORK+":"+n._getNetworkState())};this._networkInfo.addEventListener("networkstatuschanged",this._networkChangedEventHandler);this._adsGlobalEventManager!==null&&typeof this._adsGlobalEventManager!="undefined"&&this._adsGlobalEventManager.isInitialized===!0&&(this._globalAdEngagedHandler=this._adsGlobalEventManager.addEventListener(MicrosoftNSJS.Advertising.AdGlobalEventManager.EVENT_TYPE.AD_ENGAGED,function(t){n.element!==null&&typeof(n.element!=="undefined")&&n.element.id!==t&&n.suspend()}),this._globalAdDisengagedHandler=this._adsGlobalEventManager.addEventListener(MicrosoftNSJS.Advertising.AdGlobalEventManager.EVENT_TYPE.AD_DISENGAGED,function(t){n.element!==null&&typeof(n.element!=="undefined")&&n.element.id!==t&&n.resume()}))}catch(t){}},_setUseCustomClose:function(n){var t=this._currentCloseBandHeight;this._currentCloseBandHeight=n?0:this._RESERVED_CLOSE_BAND_HEIGHT;t!==this._currentCloseBandHeight&&this._setOrmmaScreenSize(this._adIFrame)},_disposeAdPlacement:function(){this._placement!==null&&(this._placement.onadrefreshed=null,this._placement.onerroroccurred=null,this._placement=null)},_onRemove:function(){this._unscheduleRefresh();this._stopOrientationMonitoring();this._networkInfo.removeEventListener("networkstatuschanged",this._networkChangedEventHandler);this._disposeAdPlacement()},_onDocumentResize:function(){this._adIFrame!==null&&(this._setOrmmaScreenSize(this._adIFrame),this._ormmaState===this._ORMMA_STATE_EXPANDED&&(this._positionExpandedFrame(),this._setOrmmaScreenSize(this._expandedIFrame)))},_setOrmmaScreenSize:function(n){var t={height:document.documentElement.offsetHeight-this._currentCloseBandHeight,width:document.documentElement.offsetWidth};t.height<0&&(t.height=0);this._sendMessageToAdContainer(n,this._MSG_TYPE_SETSCREENSIZE+":"+JSON.stringify(t))},_onResize:function(){var n=this.element.offsetWidth,t=this.element.offsetHeight,i=this._currentAdWidth,r=this._currentAdHeight;n!==i||t!==r?this._requestInProgress||(this._unscheduleRefresh(),this._refreshInternal()):this._scheduleRefresh()},_updateExpandProperties:function(n){try{this._expandProperties=JSON.parse(n)}catch(i){this._reportError(this._MSG_TYPE_SETEXPANDPROPERTIES,"unable to parse expand properties as json");return}if(this._isExpanded&&this._expandedIFrame!==null){var t=this._getExpandedBounds();this._expandedIFrame.style.top=t.y+"px";this._expandedIFrame.style.left=t.x+"px";this._expandedIFrame.width=t.width+"px";this._expandedIFrame.height=t.height+"px";this._setSize(this._expandedIFrame,t.width,t.height)}},_getExpandedBounds:function(){var i=document.documentElement.offsetHeight,r=document.documentElement.offsetWidth,u=0,f=0,n=i-this._currentCloseBandHeight,t=r;return this._expandProperties&&(t=this._expandProperties.width!==undefined?this._expandProperties.width:t,n=this._expandProperties.height!==undefined?this._expandProperties.height:n,n>i-this._currentCloseBandHeight&&(t=t*(i-this._currentCloseBandHeight)/n,n=i-this._currentCloseBandHeight),t>r&&(n=n*(r/t),t=r),u=(r-t)/2,f=(i-n)/2),{x:u,y:f,width:t,height:n}},_expand:function(n){var r,u;if(!this._isExpanded&&(typeof window._msAdEngaged=="undefined"||!window._msAdEngaged)){var f=document.documentElement.offsetHeight,e=document.documentElement.offsetWidth,t=this._getExpandedBounds(),i=2147483637;try{this._overlayDiv=document.createElement("div");this._overlayDiv.style.zIndex=i-1;this._overlayDiv.style.position="absolute";this._overlayDiv.style.top="0px";this._overlayDiv.style.left="0px";this._overlayDiv.style.width="100%";this._overlayDiv.style.height="100%";this._overlayDiv.id=this._domElement.id+"_overlayDiv";this._overlayDiv.style.backgroundColor="#000000";this._overlayDiv.style.opacity=.8;r=this;this._overlayDiv.onclick=function(){r._closePopup()};document.body.appendChild(this._overlayDiv);this._expandedIFrame=document.createElement("iframe");this._expandedIFrame.id=this._domElement.id+"_expandIframe";this._expandedIFrame.style.top=t.y+"px";this._expandedIFrame.style.left=t.x+"px";this._expandedIFrame.style.zIndex=i;this._expandedIFrame.style.position="absolute";this._expandedIFrame.width=t.width+"px";this._expandedIFrame.height=t.height+"px";this._expandedIFrame.marginwidth="0px";this._expandedIFrame.marginheight="0px";this._expandedIFrame.frameBorder="0px";this._expandedIFrame.onblur=function(n){try{n.currentTarget.focus()}catch(t){}};this._expandedIFrame.addEventListener("focus",function(){this._sendMessageToAdContainer(this._expandedIFrame,this._MSG_TYPE_SETFOCUS+":true")}.bind(this));document.body.appendChild(this._expandedIFrame)}catch(o){this._overlayDiv=this._disposeElement(this._overlayDiv);this._expandedIFrame=this._disposeElement(this._expandedIFrame);return}if(typeof n=="string"&&n.length!==0)this._expandedIFrame.src=n,this._expandedIFrame.style.backgroundColor="#FFFFFF";else{this._expandedIFrame.src="ms-appx-web:///MSAdvertisingJS/ads/bootstrap.html";this._sendMessageToAdContainer(this._expandedIFrame,this._MSG_TYPE_SETID+":"+this._domElement.id);this._adInstanceState!==null&&this._sendMessageToAdContainer(this._expandedIFrame,this._MSG_TYPE_SETADINSTANCESTATE+":"+this._adInstanceState);this._initializeOrmma(this._expandedIFrame,t.width,t.height,this._ORMMA_STATE_EXPANDED);this._sendAdDataToAdContainer(this._expandedIFrame,this._rendererContent,this._rendererParams,this._prmParams);try{this._adsGlobalEventManager.broadcastEvent(MicrosoftNSJS.Advertising.AdGlobalEventManager.EVENT_TYPE.AD_ENGAGED,this.element.id)}catch(o){this._log("this._adsGlobalEventManager could not be called")}}this._unscheduleRefresh();this._setState(this._ORMMA_STATE_EXPANDED);this._adIFrame!==null&&typeof this._adIFrame=="object"&&this._setSize(this._adIFrame,t.width,t.height);u=this.isEngaged;this._isExpanded=!0;window._msAdEngaged=!0;u!==this.isEngaged&&this._fireEngagedChanged()}},_disposeElement:function(n){if(n!==null&&typeof n=="object")try{return document.body.removeChild(n),null}catch(t){this._log("unable to remove node")}return n},_closePopup:function(){this._overlayDiv!==null&&typeof this._overlayDiv!="undefined"&&(this._removeFromParent(this._overlayDiv),this._overlayDiv=null);this._expandedIFrame!==null&&(this._expandedIFrame.src="about:blank",this._removeFromParent(this._expandedIFrame),this._expandedIFrame=null);this._setState(this._previousOrmmaState);this._scheduleRefresh();this._adIFrame!==null&&typeof this._adIFrame=="object"&&this._setSize(this._adIFrame,this._adIFrame.width,this._adIFrame.height);var n=this.isEngaged;this._isExpanded=!1;window._msAdEngaged=!1;n!==this.isEngaged&&this._fireEngagedChanged();try{this._adsGlobalEventManager.broadcastEvent(MicrosoftNSJS.Advertising.AdGlobalEventManager.EVENT_TYPE.AD_DISENGAGED,this.element.id)}catch(t){this._log("this._adsGlobalEventManager could not be called")}},_positionExpandedFrame:function(){if(this._expandedIFrame!==null){var n=document.documentElement.offsetWidth,t=document.documentElement.offsetHeight,i=(n-this._expandedIFrame.width)/2,r=(t-this._expandedIFrame.height)/2;this._expandedIFrame.style.left=i+"px";this._expandedIFrame.style.top=r+"px"}},_resize:function(n,t,i){this._adIFrame!==null&&typeof this._adIFrame!="undefined"&&(this._adIFrame.height=t,this._adIFrame.width=n,this._setSize(this._adIFrame,n,t),this._setState(i))},_setState:function(n){this._previousOrmmaState=this._ormmaState;this._ormmaState=n;this._sendMessageToAllAdContainers(this._MSG_TYPE_SETSTATE+":"+n)},_setSize:function(n,t,i){this._sendMessageToAdContainer(n,this._MSG_TYPE_SETSIZE+":"+JSON.stringify({height:i,width:t}))},_processSetUserEngaged:function(n){var t,i;n===null||n.indexOf("=")===-1?this._log("invalid setUserEngaged message: "+n):(t=n.split("="),t[0]==="engaged"?(i=this.isEngaged,this._isUserEngaged=t[1]==="true",this._isAutoRefreshEnabled&&(this._isUserEngaged?this._unscheduleRefresh():this._scheduleRefresh()),i!==this.isEngaged&&this._fireEngagedChanged()):this._log("invalid setUserEngaged message: "+n))},_processTiltMessage:function(n){if(n===null||n.indexOf("=")===-1)this._log("invalid tilt message: "+n);else{var t=n.split("=");t[0]===this._MSG_TYPE_LISTENER?t[1]===this._MSG_TYPE_VALUESTART?this._startTiltAccelerometer():t[1]===this._MSG_TYPE_VALUESTOP?this._stopTiltAccelerometer():this._log("invalid tilt message: "+n):t[0]===this._MSG_TYPE_GETTILT&&t[1]===this._MSG_TYPE_REFRESH?this._getTilt():this._log("invalid tilt message: "+n)}},_processShakeMessage:function(n){if(n===null||n.indexOf("=")===-1)this._log("invalid shake message: "+n);else{var t=n.split("=");t[0]===this._MSG_TYPE_LISTENER?t[1]===this._MSG_TYPE_VALUESTART?this._startShakeAccelerometer():t[1]===this._MSG_TYPE_VALUESTOP?this._stopShakeAccelerometer():this._log("invalid shake message: "+n):this._log("invalid shake message: "+n)}},_startTiltAccelerometer:function(){if(this._checkAndCreateAccelerometer())try{(typeof this._accelerometer.tiltHandlers[this._ad.guid]=="undefined"||this._accelerometer.tiltHandlers[this._ad.guid]===null)&&this._accelerometer.device.addEventListener("readingchanged",this._generateTiltListener())}catch(n){}},_generateTiltListener:function(){try{var n=this,t=function(t){var i=n._generateCoordsMessage(t.reading.accelerationX,t.reading.accelerationY,t.reading.accelerationZ);n._sendMessageToAllAdContainers(n._MSG_TYPE_UPDATETILTCOORDS+":{"+i+"}")};return this._accelerometer!==null&&typeof this._accelerometer!="undefined"&&(this._accelerometer.tiltHandlers[n._ad.guid]=t),t}catch(i){return}},_generateCoordsMessage:function(n,t,i){return'"x":"'+n+'","y":"'+t+'","z":"'+i+'"'},_stopTiltAccelerometer:function(){try{var n=this._accelerometer.tiltHandlers[this._ad.guid];n!==null&&typeof n!="undefined"&&(this._accelerometer.device.removeEventListener("readingchanged",n),this._accelerometer.tiltHandlers[this._ad.guid]=null)}catch(t){this._log("could not stop the tilt accelerometer")}},_startShakeAccelerometer:function(){if(this._checkAndCreateAccelerometer())try{(typeof this._accelerometer.shakeHandlers[this._ad.guid]=="undefined"||this._accelerometer.shakeHandlers[this._ad.guid]===null)&&this._accelerometer.device.addEventListener("shaken",this._generateShakeListener())}catch(n){this._log("could not start the shake accelerometer")}},_generateShakeListener:function(){var n=this,t=function(){n._sendMessageToAllAdContainers(n._MSG_TYPE_FIRESHAKE)};return this._accelerometer!==null&&typeof this._accelerometer!="undefined"&&(this._accelerometer.shakeHandlers[n._ad.guid]=t),t},_stopShakeAccelerometer:function(){try{var n=this._accelerometer.shakeHandlers[this._ad.guid];n!==null&&typeof n!="undefined"&&(this._accelerometer.device.removeEventListener("shaken",n),this._accelerometer.shakeHandlers[this._ad.guid]=null)}catch(t){this._log("could not stop shake accelerometer")}},_getTilt:function(){var n,i,t;if(this._checkAndCreateAccelerometer())try{n=this._lastCoords;i=this._generateCoordsMessage(n.x,n.y,n.z);this._sendMessageToAllAdContainers(this._MSG_TYPE_UPDATETILTCOORDS+":{"+i+"}");t=this._accelerometer.device.getCurrentReading();this._lastCoords={x:t.accelerationX,y:t.accelerationY,z:t.accelerationZ}}catch(r){this._log("error in getTilt")}},_disposeAccelerometer:function(){this._accelerometer!==null&&this._accelerometer.device!==null&&typeof this._accelerometer.device=="object"&&(this._stopShakeAccelerometer(),this._stopTiltAccelerometer())},_checkAndCreateAccelerometer:function(){(this._accelerometer===null||typeof this._accelerometer.device!="object")&&(this._accelerometer={});try{return((this._accelerometer.device===null||typeof this._accelerometer.device!="object")&&(this._accelerometer.device=Windows.Devices.Sensors.Accelerometer.getDefault(),this._accelerometer.device.reportInterval=this._sensorOptions.accelerometer.reportIntervalMS),this._accelerometer.device===null||typeof this._accelerometer.device!="object")?(this._log("could not instantiate the accelerometer object, is the sensor online?"),!1):!0}catch(n){return!1}},_processViewableChangeMessage:function(n){if(n===null||n.indexOf("=")===-1)this._log("invalid viewable change message: "+n);else{var t=n.split("=");t[0]===this._MSG_TYPE_LISTENER?t[1]===this._MSG_TYPE_VALUESTART?this._startViewableChangeMonitoring():t[1]===this._MSG_TYPE_VALUESTOP?this._stopViewableChangeMonitoring():this._log("invalid viewable change message: "+n):this._log("invalid viewably change message: "+n)}},_storeAdInstanceState:function(n){this._adInstanceState=n;this._ormmaState===this._ORMMA_STATE_EXPANDED&&this._sendMessageToAdContainer(this._adIFrame,this._MSG_TYPE_SETADINSTANCESTATE+":"+this._adInstanceState)},_startViewableChangeMonitoring:function(){if(this._viewableChangedTimer===null){this._sendMessageToAdContainer(this._adIFrame,this._MSG_TYPE_VIEWABLECHANGE+":"+JSON.stringify({viewable:this._isViewable()}));var n=this;this._viewableChangedTimer=window.setInterval(function(){var t=n._isViewable();n._hasViewablility!==t&&(n._hasViewablility=t,n._sendMessageToAdContainer(n._adIFrame,n._MSG_TYPE_VIEWABLECHANGE+":"+JSON.stringify({viewable:t})))},this._viewableCheckPeriodMs)}this._hasViewablility=this._isViewable();this._sendMessageToAdContainer(this._adIFrame,this._MSG_TYPE_VIEWABLECHANGE+":"+JSON.stringify({viewable:this._hasViewablility}))},_stopViewableChangeMonitoring:function(){this._viewableChangedTimer!==null&&typeof this._viewableChangedTimer=="number"&&(window.clearInterval(this._viewableChangedTimer),this._viewableChangedTimer=null)},_processGetOrientationMessage:function(n){if(n!==null&&n.indexOf("=")!==-1){var t=n.split("=");t[0]===this._MSG_TYPE_LISTENER?t[1]===this._MSG_TYPE_VALUESTART?this._startOrientationMonitoring():t[1]===this._MSG_TYPE_VALUESTOP?this._stopOrientationMonitoring():this._log("invalid orientation message: "+n):this._log("invalid orientation message: "+n)}},_updateOrienation:function(){var n=-1;try{switch(Windows.Graphics.Display.DisplayProperties.currentOrientation){case Windows.Graphics.Display.DisplayOrientations.landscape:n=270;break;case Windows.Graphics.Display.DisplayOrientations.landscapeFlipped:n=90;break;case Windows.Graphics.Display.DisplayOrientations.portraitFlipped:n=180;break;case Windows.Graphics.Display.DisplayOrientations.portrait:n=0;break;default:n=-1}this._sendMessageToAllAdContainers(this._MSG_TYPE_UPDATEORIENTATION+":"+JSON.stringify({orientation:n}))}catch(t){control._reportError(control._MSG_TYPE_UPDATEORIENTATION,"Unable to communicate with orientation sensor.")}},_startOrientationMonitoring:function(){try{if(typeof this._orientationChangedHandler!="function"){var n=this;this._orientationChangedHandler=function(){n._updateOrienation()};Windows.Graphics.Display.DisplayProperties.addEventListener("orientationchanged",this._orientationChangedHandler)}}catch(t){control._reportError(control._MSG_TYPE_UPDATEORIENTATION,"Unable to communicate with orientation sensor.")}},_stopOrientationMonitoring:function(){try{typeof this._orientationChangedHandler=="function"&&(Windows.Graphics.Display.DisplayProperties.removeEventListener("orientationchanged",this._orientationChangedHandler),this._orientationChangedHandler=null)}catch(n){control._reportError(control._MSG_TYPE_UPDATEORIENTATION,"Unable to communicate with orientation sensor.")}},_scheduleRefresh:function(){if(this._isAutoRefreshEnabled&&this._refreshTimerId===null){var n=this;this._refreshTimerId=setTimeout(function(){n._refreshTimerId=null;n._refreshInternal()},this._refreshPeriodSeconds*1e3)}},_unscheduleRefresh:function(){this._refreshTimerId!==null&&(clearTimeout(this._refreshTimerId),this._refreshTimerId=null)},_request:function(n){if(this._getNetworkState()===this._ORMMA_NETWORK_OFFLINE){this._reportError(this._MSG_TYPE_REQUEST,"http request error, network offline");return}try{var i=this,t=new XMLHttpRequest;n.display.toLowerCase()!==this._ORMMA_RESPONSE_IGNORE&&(t.onreadystatechange=function(){if(this.readyState===XMLHttpRequest.DONE)if(this.status===200){var r={url:escape(n.url),response:escape(this.responseText)};i._sendMessageToAllAdContainers("ormmaResponse:"+JSON.stringify(r))}else i._reportError(i._MSG_TYPE_REQUEST,"error on request to url: "+n.url+": code "+t.status)});t.open("GET",n.url,!0);t.setRequestHeader(this._HTTP_HEADER_CACHE_CONTROL,this._HTTP_HEADER_VALUE_CACHE_CONTROL_NO_CACHE);t.timeout=1e4;t.send(null)}catch(r){this._reportError(this._MSG_TYPE_REQUEST,"http request error: "+r.message)}},_validateParameters:function(){return this._applicationId===null||this._applicationId===""||this._adUnitId===null||this._adUnitId===""?(this._fireErrorOccurred("ad control requires applicationId and adUnitId properties to be set",this._ERROR_ENUM.ClientConfiguration),!1):typeof this.latitude!="undefined"&&!this._validateNumber("latitude",this.latitude)?!1:typeof this.longitude!="undefined"&&!this._validateNumber("longitude",this.longitude)?!1:!0},_validateNumber:function(n,t){if(typeof t=="number"){if(isNaN(t))return this._fireErrorOccurred(n+" value is not a valid number (NaN)",this._ERROR_ENUM.ClientConfiguration),!1}else return this._fireErrorOccurred(n+" value is not a valid type: "+typeof t,this._ERROR_ENUM.ClientConfiguration),!1;return!0},_getUri:function(n){if(n!==null&&typeof n=="object"&&typeof n.url=="string"&&n.url.length<=this._MAX_URL_LENGTH)try{var t=new Windows.Foundation.Uri(n.url);if(t.schemeName==="http"||t.schemeName==="https"||t.schemeName==="ms-windows-store"||t.schemeName==="skype"||t.schemeName==="microsoftmusic"||t.schemeName==="xboxsmartglass"||t.schemeName==="xboxgames"||t.schemeName==="microsoftvideo"||t.schemeName==="bingtravel"||t.schemeName==="bingweather"||t.schemeName==="bingmaps"||t.schemeName==="bingfinance"||t.schemeName==="bingsports"||t.schemeName==="bingnews")return t}catch(i){}return null},_getNetworkState:function(){var n,t;try{return n=this._networkInfo.getInternetConnectionProfile(),n&&n.getNetworkConnectivityLevel()!==Windows.Networking.Connectivity.NetworkConnectivityLevel.none?(t=n.networkAdapter.ianaInterfaceType,t===6||t===71?this._ORMMA_NETWORK_WIFI:this._ORMMA_NETWORK_CELL):this._ORMMA_NETWORK_OFFLINE}catch(i){this._log("error getting network state: "+(i!==null&&typeof i=="object"?i.message:"???"))}return this._ORMMA_NETWORK_UNKNOWN},_isElementAllowed:function(n){if(n!==null&&typeof n=="object"&&typeof n.tagName=="string"){var t=n.tagName.toLowerCase();return t==="button"||t==="menu"||t==="ol"||t==="textarea"||t==="ul"||t==="canvas"||t==="embed"||t==="html"||t==="iframe"||t==="img"||t==="input"||t==="select"||t==="video"||t==="a"?!1:!0}return!1}})})})(WinJS);
/*!
  Copyright (C) Microsoft. All rights reserved.
  This library is supported for use in Windows Store apps only.
*/
(function(n){"use strict";var t=n.Class.define(function(n){if(!this._isNullOrUndefined(window)){if(this._isNullOrUndefined(window._msAdsAdSettingsControl)||window._msAdsAdSettingsControl.isInitialized!==!0){if(this._isNullOrUndefined(window._msAdsAdSettingsControl)||window._msAdsAdSettingsControl._objectName===MicrosoftNSJS.Advertising.AdSettingsControl.OBJECT_NAME){if(!this._isNullOrUndefined(window._msAdsAdSettingsControl)&&window._msAdsAdSettingsControl.isInitialized===!1)return this._logError("warning: window._msAdsAdSettingsControl already exists but is not initialized yet (are all promises complete?). Try again later or dispose and re-create."),window._msAdsAdSettingsControl}else this._logError("window._msAdsAdSettingsControl already exists but is not of correct object type [{0}]. Overwriting.",MicrosoftNSJS.Advertising.AdSettingsControl.OBJECT_NAME);try{this._objectName=MicrosoftNSJS.Advertising.AdSettingsControl.OBJECT_NAME;this._isInitialized=!1;window._msAdsAdSettingsControl=this;this._initialize(n);MicrosoftAdvertising.Shared.WinRT.UserInfoProvider.initialize().then(function(){this._isInitialized=!0;this._addSettingsFlyout()}.bind(this),function(n){this._logError("could not initialize UserInfoProvider. Error:",n);this._dispose()}.bind(this))}catch(t){this._dispose();this._logError("could not initialize AdSettingsControl error: {0}",t)}}return window._msAdsAdSettingsControl}},{_flyoutHtmlTemplateURI:"",_resourceLoader:null,_userInfoProvider:null,_targetingOptInState:null,_eventHandlers:{optToggle_Toggled:null,signInLink_Clicked:null,settingsFlyout_Activated:null},isInitialized:{get:function(){return this._isInitialized}},dispose:function(){try{this._dispose()}catch(n){try{this._logError("Could not dispose, exception thrown [{0}].",n)}catch(n){}}},_initialize:function(n){if(!this._isNullOrUndefined(n)&&(this._isNullOrUndefined(n.flyoutHtmlTemplateURI)||(this._flyoutHtmlTemplateURI=n.flyoutHtmlTemplateURI),!this._isNullOrUndefined(n.resourceLoaderURI)))try{this._resourceLoader=Windows.ApplicationModel.Resources.ResourceLoader(n.resourceLoaderURI)}catch(t){this._logError("Could not initialize, error: [{0}].",t)}this._userInfoProvider=MicrosoftAdvertising.Shared.WinRT.UserInfoProvider;this._targetingOptInState=MicrosoftAdvertising.Shared.WinRT.TargetingOptInState;this._createSettingsFlyoutEvent()},_addSettingsFlyout:function(){n.Application.addEventListener("settings",this._eventHandlers.settingsFlyout_Activated)},_createSettingsFlyoutEvent:function(){this._eventHandlers.settingsFlyout_Activated=function(t){try{if(MicrosoftAdvertising.Shared.WinRT.UserInfoProvider.isUserOptOutControlVisible()===!1)return;var i={name:"msaAdSettings",title:this._resourceLoader.getString("AdSettings_CommandText"),href:this._flyoutHtmlTemplateURI},r=Windows.UI.ApplicationSettings,u=new r.SettingsCommand(i.name,i.title,function(){n.UI.SettingsFlyout.showSettings(i.name,i.href)});t.detail.e.request.applicationCommands.append(u);this._wirePanelScript()}catch(f){this._logError("could not add settings flyout html in WinJS.Application.onsettings handler")}}.bind(this)},_wirePanelScript:function(){this._createPageEvents();var t=n.UI.Pages.define(this._flyoutHtmlTemplateURI,{ready:function(){document.getElementById("optToggle").winControl.addEventListener("change",this._eventHandlers.optToggle_Toggled);document.getElementById("signInLink").addEventListener("click",this._eventHandlers.signInLink_Clicked);this._updateResourceStrings();this._toggleProgress(!0);this._userInfoProvider.getGlobalTargetingOptInStateAsync().then(function(n){this._updateUI(n)}.bind(this),function(){this._showUnknownState()}.bind(this))}.bind(this),unload:function(){document.getElementById("optToggle").winControl.removeEventListener("change",this._eventHandlers.optToggle_Toggled);document.getElementById("signInLink").removeEventListener("click",this._eventHandlers.signInLink_Clicked)}.bind(this)})},_createPageEvents:function(){this._eventHandlers.optToggle_Toggled=function(n){try{this._userInfoProvider.setLocalTargetingOptInStateAsync(n.target.winControl.checked)}catch(i){var t=document.getElementById("optToggle");t.winControl.checked=!t.winControl.checked}}.bind(this);this._eventHandlers.signInLink_Clicked=function(){this._userInfoProvider.requestUserSignInAsync()}.bind(this)},_updateResourceStrings:function(){this._updateElementText("mainLabel","AdSettings_Flyout_Title",this._resourceLoader);this._updateElementText("heading1Label","AdSettings_Flyout_SectionName",this._resourceLoader);this._updateElementText("signInPrompt1","AdSettings_Flyout_SignInPrompt1",this._resourceLoader);this._updateElementText("signInLink","AdSettings_Flyout_SignInPrompt_SignIn",this._resourceLoader);this._updateElementText("signInPrompt2","AdSettings_Flyout_SignInPrompt2",this._resourceLoader);this._updateElementText("optedOutPrompt1","AdSettings_Flyout_OptedOut_Message1",this._resourceLoader);this._updateElementText("optOutMoreInfoLink","AdSettings_Flyout_OptedOut_Message_Here",this._resourceLoader);this._updateElementText("optedOutPrompt2","AdSettings_Flyout_OptedOut_Message2",this._resourceLoader);this._updateElementText("statusUnknownPrompt","AdSettings_Flyout_StatusUnknown_Message",this._resourceLoader);var n=document.getElementById("optToggle").winControl;n.title=this._resourceLoader.getString("AdSettings_Flyout_OptInSwitch_Header");n.labelOff=this._resourceLoader.getString("AdSettings_Flyout_OptInSwitch_Off");n.labelOn=this._resourceLoader.getString("AdSettings_Flyout_OptInSwitch_On");this._updateElementText("privacyStatementLink","AdSettings_Flyout_Privacy",this._resourceLoader)},_updateElementText:function(n,t,i){try{document.getElementById(n).innerText=i.getString(t)}catch(r){}},_updateUI:function(n){this._toggleProgress();var t=document.getElementById("optToggle");n===this._targetingOptInState.optedIn?(document.getElementById("optedOutPrompt").style.display="none",document.getElementById("signInPrompt").style.display="none",document.getElementById("statusUnknownPrompt").style.display="none",this._userInfoProvider.getLocalTargetingOptInStateAsync().then(function(n){t.winControl.checked=n!==this._targetingOptInState.optedOut?!0:!1;t.winControl.disabled=!1;t.style.display="block"}.bind(this))):n===this._targetingOptInState.userNotSignedIn?(document.getElementById("optedOutPrompt").style.display="none",document.getElementById("signInPrompt").style.display="block",document.getElementById("statusUnknownPrompt").style.display="none",t.winControl.disabled=!0,t.winControl.checked=!1,t.style.display="block"):n===this._targetingOptInState.optedOut?(document.getElementById("optedOutPrompt").style.display="block",document.getElementById("signInPrompt").style.display="none",document.getElementById("statusUnknownPrompt").style.display="none",t.winControl.disabled=!0,t.winControl.checked=!1,t.style.display="block"):n===this._targetingOptInState.unknown?this._showUnknownState():this._showUnknownState()},_showUnknownState:function(){var n=document.getElementById("optToggle");document.getElementById("optedOutPrompt").style.display="none";document.getElementById("signInPrompt").style.display="none";document.getElementById("statusUnknownPrompt").style.display="block";n.winControl.disabled=!0;n.winControl.checked=!1;n.style.display="block"},_toggleProgress:function(n){document.getElementById("progressRing").style.display=n?"block":"none"},_dispose:function(){n.Application.removeEventListener("settings",this._eventHandlers.settingsFlyout_Activated);this._isInitialized=!1;window._msAdsAdSettingsControl=null},_isNullOrUndefined:function(n){return typeof n=="undefined"||n===null?!0:!1},_logError:function(){}},{OBJECT_NAME:"MicrosoftNSJS.Advertising.AdSettingsControl"});n.Namespace.define("MicrosoftNSJS.Advertising",{AdSettingsControl:t})})(WinJS);
/*!
  Copyright (C) Microsoft. All rights reserved.
  This library is supported for use in Windows Store apps only.
*/
(function(n){"use strict";var t=n.Class.define(function(){if(!this._isNullOrUndefined(window))return(this._isNullOrUndefined(window._msAdsGlobalEventManager)||window._msAdsGlobalEventManager.isInitialized!==!0)&&(this._isNullOrUndefined(window._msAdsGlobalEventManager)||window._msAdsGlobalEventManager._objectName===MicrosoftNSJS.Advertising.AdGlobalEventManager.OBJECT_NAME||this._logError("window._msAdsGlobalEventManager already exists but is not of correct object type [{0}]. Overwriting.",MicrosoftNSJS.Advertising.AdGlobalEventManager.OBJECT_NAME),this._objectName=MicrosoftNSJS.Advertising.AdGlobalEventManager.OBJECT_NAME,this._isInitialized=!0,window._msAdsGlobalEventManager=this),window._msAdsGlobalEventManager},{isInitialized:{get:function(){return this._isInitialized}},_eventListeners:null,_isInitialized:!1,addEventListener:function(n,t){if(this._isNullOrUndefined(n)||this._isNullOrUndefined(t)){this._logError("Could not add listener, eventType or listener null or undefined");return}try{return this._initializeEventListenersContainer(n),this._eventListeners[n].push(t),t}catch(i){return this._logError("Could not add listener type '"+n+"', exception was thrown [{0}]",i),null}},removeEventListener:function(n,t){var r,i,u;if(this._isNullOrUndefined(n)||this._isNullOrUndefined(t)){this._logError("Could not remove listener, eventType or listener null or undefined.");return}if(this._eventArrayExists(n))try{for(r=this._eventListeners[n],i=0;i<r.length;i++)if(r[i]===t)return u=r.splice(i,1),u[0]}catch(f){return this._logError("Could not remove listener, exception was thrown [{0}]",f),null}else return this._logError("Could not remove listener, no listener found for eventType: "+n),null},broadcastEvent:function(n,t){var r,i;if(this._isNullOrUndefined(n)){this._logError("Could not broadcast event, eventType null or undefined");return}if(this._eventArrayExists(n))for(r=this._eventListeners[n],i=0;i<r.length;i++)this._isNullOrUndefined(r[i])||r[i](t);else return},dispose:function(n){var t,i;try{if(n===!0){this._dispose();return}t=!1;for(i in MicrosoftNSJS.Advertising.AdGlobalEventManager.EVENT_TYPE)if(this._eventArrayExists(MicrosoftNSJS.Advertising.AdGlobalEventManager.EVENT_TYPE[i])&&this._eventListeners[MicrosoftNSJS.Advertising.AdGlobalEventManager.EVENT_TYPE[i]].length>0){t=!0;break}t===!1?this._dispose():this._logError("Could not dispose, events collection is not empty.")}catch(r){try{this._logError("Could not dispose, exception thrown [{0}].",r)}catch(r){}}},_dispose:function(){this._eventListeners=null;this._isInitialized=!1;window._msAdsGlobalEventManager=null},_initializeEventListenersContainer:function(n){this._eventListeners===null?(this._eventListeners={},this._eventListeners[n]=[]):this._isNullOrUndefined(this._eventListeners[n])&&(this._eventListeners[n]=[])},_eventArrayExists:function(n){return this._eventListeners===null||this._eventListeners[n]===null||typeof this._eventListeners[n]=="undefined"?!1:!0},_isNullOrUndefined:function(n){return typeof n=="undefined"||n===null?!0:!1},_logError:function(){}},{OBJECT_NAME:"MicrosoftNSJS.Advertising.AdGlobalEventManager",EVENT_TYPE:{AD_ENGAGED:"msAdEngaged",AD_DISENGAGED:"msAdDisengaged"}});n.Namespace.define("MicrosoftNSJS.Advertising",{AdGlobalEventManager:t})})(WinJS);
// SIG // Begin signature block
// SIG // MIIamQYJKoZIhvcNAQcCoIIaijCCGoYCAQExCzAJBgUr
// SIG // DgMCGgUAMGcGCisGAQQBgjcCAQSgWTBXMDIGCisGAQQB
// SIG // gjcCAR4wJAIBAQQQEODJBs441BGiowAQS9NQkAIBAAIB
// SIG // AAIBAAIBAAIBADAhMAkGBSsOAwIaBQAEFJ9Q7cq85Wkw
// SIG // ra21JFaTDJQ5T+ZuoIIVgjCCBMMwggOroAMCAQICEzMA
// SIG // AAAz5SeGow5KKoAAAAAAADMwDQYJKoZIhvcNAQEFBQAw
// SIG // dzELMAkGA1UEBhMCVVMxEzARBgNVBAgTCldhc2hpbmd0
// SIG // b24xEDAOBgNVBAcTB1JlZG1vbmQxHjAcBgNVBAoTFU1p
// SIG // Y3Jvc29mdCBDb3Jwb3JhdGlvbjEhMB8GA1UEAxMYTWlj
// SIG // cm9zb2Z0IFRpbWUtU3RhbXAgUENBMB4XDTEzMDMyNzIw
// SIG // MDgyM1oXDTE0MDYyNzIwMDgyM1owgbMxCzAJBgNVBAYT
// SIG // AlVTMRMwEQYDVQQIEwpXYXNoaW5ndG9uMRAwDgYDVQQH
// SIG // EwdSZWRtb25kMR4wHAYDVQQKExVNaWNyb3NvZnQgQ29y
// SIG // cG9yYXRpb24xDTALBgNVBAsTBE1PUFIxJzAlBgNVBAsT
// SIG // Hm5DaXBoZXIgRFNFIEVTTjpGNTI4LTM3NzctOEE3NjEl
// SIG // MCMGA1UEAxMcTWljcm9zb2Z0IFRpbWUtU3RhbXAgU2Vy
// SIG // dmljZTCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoC
// SIG // ggEBAMreyhkPH5ZWgl/YQjLUCG22ncDC7Xw4q1gzrWuB
// SIG // ULiIIQpdr5ctkFrHwy6yTNRjdFj938WJVNALzP2chBF5
// SIG // rKMhIm0z4K7eJUBFkk4NYwgrizfdTwdq3CrPEFqPV12d
// SIG // PfoXYwLGcD67Iu1bsfcyuuRxvHn/+MvpVz90e+byfXxX
// SIG // WC+s0g6o2YjZQB86IkHiCSYCoMzlJc6MZ4PfRviFTcPa
// SIG // Zh7Hc347tHYXpqWgoHRVqOVgGEFiOMdlRqsEFmZW6vmm
// SIG // y0LPXVRkL4H4zzgADxBr4YMujT5I7ElWSuyaafTLDxD7
// SIG // BzRKYmwBjW7HIITKXNFjmR6OXewPpRZIqmveIS8CAwEA
// SIG // AaOCAQkwggEFMB0GA1UdDgQWBBQAWBs+7cXxBpO+MT02
// SIG // tKwLXTLwgTAfBgNVHSMEGDAWgBQjNPjZUkZwCu1A+3b7
// SIG // syuwwzWzDzBUBgNVHR8ETTBLMEmgR6BFhkNodHRwOi8v
// SIG // Y3JsLm1pY3Jvc29mdC5jb20vcGtpL2NybC9wcm9kdWN0
// SIG // cy9NaWNyb3NvZnRUaW1lU3RhbXBQQ0EuY3JsMFgGCCsG
// SIG // AQUFBwEBBEwwSjBIBggrBgEFBQcwAoY8aHR0cDovL3d3
// SIG // dy5taWNyb3NvZnQuY29tL3BraS9jZXJ0cy9NaWNyb3Nv
// SIG // ZnRUaW1lU3RhbXBQQ0EuY3J0MBMGA1UdJQQMMAoGCCsG
// SIG // AQUFBwMIMA0GCSqGSIb3DQEBBQUAA4IBAQAC/+OMA+rv
// SIG // fji5uXyfO1KDpPojONQDuGpZtergb4gD9G9RapU6dYXo
// SIG // HNwHxU6dG6jOJEcUJE81d7GcvCd7j11P/AaLl5f5KZv3
// SIG // QB1SgY52SAN+8psXt67ZWyKRYzsyXzX7xpE8zO8OmYA+
// SIG // BpE4E3oMTL4z27/trUHGfBskfBPcCvxLiiAFHQmJkTkH
// SIG // TiFO3mx8cLur8SCO+Jh4YNyLlM9lvpaQD6CchO1ctXxB
// SIG // oGEtvUNnZRoqgtSniln3MuOj58WNsiK7kijYsIxTj2hH
// SIG // R6HYAbDxYRXEF6Et4zpsT2+vPe7eKbBEy8OSZ7oAzg+O
// SIG // Ee/RAoIxSZSYnVFIeK0d1kC2MIIE7DCCA9SgAwIBAgIT
// SIG // MwAAALARrwqL0Duf3QABAAAAsDANBgkqhkiG9w0BAQUF
// SIG // ADB5MQswCQYDVQQGEwJVUzETMBEGA1UECBMKV2FzaGlu
// SIG // Z3RvbjEQMA4GA1UEBxMHUmVkbW9uZDEeMBwGA1UEChMV
// SIG // TWljcm9zb2Z0IENvcnBvcmF0aW9uMSMwIQYDVQQDExpN
// SIG // aWNyb3NvZnQgQ29kZSBTaWduaW5nIFBDQTAeFw0xMzAx
// SIG // MjQyMjMzMzlaFw0xNDA0MjQyMjMzMzlaMIGDMQswCQYD
// SIG // VQQGEwJVUzETMBEGA1UECBMKV2FzaGluZ3RvbjEQMA4G
// SIG // A1UEBxMHUmVkbW9uZDEeMBwGA1UEChMVTWljcm9zb2Z0
// SIG // IENvcnBvcmF0aW9uMQ0wCwYDVQQLEwRNT1BSMR4wHAYD
// SIG // VQQDExVNaWNyb3NvZnQgQ29ycG9yYXRpb24wggEiMA0G
// SIG // CSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQDor1yiIA34
// SIG // KHy8BXt/re7rdqwoUz8620B9s44z5lc/pVEVNFSlz7SL
// SIG // qT+oN+EtUO01Fk7vTXrbE3aIsCzwWVyp6+HXKXXkG4Un
// SIG // m/P4LZ5BNisLQPu+O7q5XHWTFlJLyjPFN7Dz636o9UEV
// SIG // XAhlHSE38Cy6IgsQsRCddyKFhHxPuRuQsPWj/ov0DJpO
// SIG // oPXJCiHiquMBNkf9L4JqgQP1qTXclFed+0vUDoLbOI8S
// SIG // /uPWenSIZOFixCUuKq6dGB8OHrbCryS0DlC83hyTXEmm
// SIG // ebW22875cHsoAYS4KinPv6kFBeHgD3FN/a1cI4Mp68fF
// SIG // SsjoJ4TTfsZDC5UABbFPZXHFAgMBAAGjggFgMIIBXDAT
// SIG // BgNVHSUEDDAKBggrBgEFBQcDAzAdBgNVHQ4EFgQUWXGm
// SIG // WjNN2pgHgP+EHr6H+XIyQfIwUQYDVR0RBEowSKRGMEQx
// SIG // DTALBgNVBAsTBE1PUFIxMzAxBgNVBAUTKjMxNTk1KzRm
// SIG // YWYwYjcxLWFkMzctNGFhMy1hNjcxLTc2YmMwNTIzNDRh
// SIG // ZDAfBgNVHSMEGDAWgBTLEejK0rQWWAHJNy4zFha5TJoK
// SIG // HzBWBgNVHR8ETzBNMEugSaBHhkVodHRwOi8vY3JsLm1p
// SIG // Y3Jvc29mdC5jb20vcGtpL2NybC9wcm9kdWN0cy9NaWND
// SIG // b2RTaWdQQ0FfMDgtMzEtMjAxMC5jcmwwWgYIKwYBBQUH
// SIG // AQEETjBMMEoGCCsGAQUFBzAChj5odHRwOi8vd3d3Lm1p
// SIG // Y3Jvc29mdC5jb20vcGtpL2NlcnRzL01pY0NvZFNpZ1BD
// SIG // QV8wOC0zMS0yMDEwLmNydDANBgkqhkiG9w0BAQUFAAOC
// SIG // AQEAMdduKhJXM4HVncbr+TrURE0Inu5e32pbt3nPApy8
// SIG // dmiekKGcC8N/oozxTbqVOfsN4OGb9F0kDxuNiBU6fNut
// SIG // zrPJbLo5LEV9JBFUJjANDf9H6gMH5eRmXSx7nR2pEPoc
// SIG // sHTyT2lrnqkkhNrtlqDfc6TvahqsS2Ke8XzAFH9IzU2y
// SIG // RPnwPJNtQtjofOYXoJtoaAko+QKX7xEDumdSrcHps3Om
// SIG // 0mPNSuI+5PNO/f+h4LsCEztdIN5VP6OukEAxOHUoXgSp
// SIG // Rm3m9Xp5QL0fzehF1a7iXT71dcfmZmNgzNWahIeNJDD3
// SIG // 7zTQYx2xQmdKDku/Og7vtpU6pzjkJZIIpohmgjCCBbww
// SIG // ggOkoAMCAQICCmEzJhoAAAAAADEwDQYJKoZIhvcNAQEF
// SIG // BQAwXzETMBEGCgmSJomT8ixkARkWA2NvbTEZMBcGCgmS
// SIG // JomT8ixkARkWCW1pY3Jvc29mdDEtMCsGA1UEAxMkTWlj
// SIG // cm9zb2Z0IFJvb3QgQ2VydGlmaWNhdGUgQXV0aG9yaXR5
// SIG // MB4XDTEwMDgzMTIyMTkzMloXDTIwMDgzMTIyMjkzMlow
// SIG // eTELMAkGA1UEBhMCVVMxEzARBgNVBAgTCldhc2hpbmd0
// SIG // b24xEDAOBgNVBAcTB1JlZG1vbmQxHjAcBgNVBAoTFU1p
// SIG // Y3Jvc29mdCBDb3Jwb3JhdGlvbjEjMCEGA1UEAxMaTWlj
// SIG // cm9zb2Z0IENvZGUgU2lnbmluZyBQQ0EwggEiMA0GCSqG
// SIG // SIb3DQEBAQUAA4IBDwAwggEKAoIBAQCycllcGTBkvx2a
// SIG // YCAgQpl2U2w+G9ZvzMvx6mv+lxYQ4N86dIMaty+gMuz/
// SIG // 3sJCTiPVcgDbNVcKicquIEn08GisTUuNpb15S3GbRwfa
// SIG // /SXfnXWIz6pzRH/XgdvzvfI2pMlcRdyvrT3gKGiXGqel
// SIG // cnNW8ReU5P01lHKg1nZfHndFg4U4FtBzWwW6Z1KNpbJp
// SIG // L9oZC/6SdCnidi9U3RQwWfjSjWL9y8lfRjFQuScT5EAw
// SIG // z3IpECgixzdOPaAyPZDNoTgGhVxOVoIoKgUyt0vXT2Pn
// SIG // 0i1i8UU956wIAPZGoZ7RW4wmU+h6qkryRs83PDietHdc
// SIG // pReejcsRj1Y8wawJXwPTAgMBAAGjggFeMIIBWjAPBgNV
// SIG // HRMBAf8EBTADAQH/MB0GA1UdDgQWBBTLEejK0rQWWAHJ
// SIG // Ny4zFha5TJoKHzALBgNVHQ8EBAMCAYYwEgYJKwYBBAGC
// SIG // NxUBBAUCAwEAATAjBgkrBgEEAYI3FQIEFgQU/dExTtMm
// SIG // ipXhmGA7qDFvpjy82C0wGQYJKwYBBAGCNxQCBAweCgBT
// SIG // AHUAYgBDAEEwHwYDVR0jBBgwFoAUDqyCYEBWJ5flJRP8
// SIG // KuEKU5VZ5KQwUAYDVR0fBEkwRzBFoEOgQYY/aHR0cDov
// SIG // L2NybC5taWNyb3NvZnQuY29tL3BraS9jcmwvcHJvZHVj
// SIG // dHMvbWljcm9zb2Z0cm9vdGNlcnQuY3JsMFQGCCsGAQUF
// SIG // BwEBBEgwRjBEBggrBgEFBQcwAoY4aHR0cDovL3d3dy5t
// SIG // aWNyb3NvZnQuY29tL3BraS9jZXJ0cy9NaWNyb3NvZnRS
// SIG // b290Q2VydC5jcnQwDQYJKoZIhvcNAQEFBQADggIBAFk5
// SIG // Pn8mRq/rb0CxMrVq6w4vbqhJ9+tfde1MOy3XQ60L/svp
// SIG // LTGjI8x8UJiAIV2sPS9MuqKoVpzjcLu4tPh5tUly9z7q
// SIG // QX/K4QwXaculnCAt+gtQxFbNLeNK0rxw56gNogOlVuC4
// SIG // iktX8pVCnPHz7+7jhh80PLhWmvBTI4UqpIIck+KUBx3y
// SIG // 4k74jKHK6BOlkU7IG9KPcpUqcW2bGvgc8FPWZ8wi/1wd
// SIG // zaKMvSeyeWNWRKJRzfnpo1hW3ZsCRUQvX/TartSCMm78
// SIG // pJUT5Otp56miLL7IKxAOZY6Z2/Wi+hImCWU4lPF6H0q7
// SIG // 0eFW6NB4lhhcyTUWX92THUmOLb6tNEQc7hAVGgBd3TVb
// SIG // Ic6YxwnuhQ6MT20OE049fClInHLR82zKwexwo1eSV32U
// SIG // jaAbSANa98+jZwp0pTbtLS8XyOZyNxL0b7E8Z4L5UrKN
// SIG // MxZlHg6K3RDeZPRvzkbU0xfpecQEtNP7LN8fip6sCvsT
// SIG // J0Ct5PnhqX9GuwdgR2VgQE6wQuxO7bN2edgKNAltHIAx
// SIG // H+IOVN3lofvlRxCtZJj/UBYufL8FIXrilUEnacOTj5XJ
// SIG // jdibIa4NXJzwoq6GaIMMai27dmsAHZat8hZ79haDJLmI
// SIG // z2qoRzEvmtzjcT3XAH5iR9HOiMm4GPoOco3Boz2vAkBq
// SIG // /2mbluIQqBC0N1AI1sM9MIIGBzCCA++gAwIBAgIKYRZo
// SIG // NAAAAAAAHDANBgkqhkiG9w0BAQUFADBfMRMwEQYKCZIm
// SIG // iZPyLGQBGRYDY29tMRkwFwYKCZImiZPyLGQBGRYJbWlj
// SIG // cm9zb2Z0MS0wKwYDVQQDEyRNaWNyb3NvZnQgUm9vdCBD
// SIG // ZXJ0aWZpY2F0ZSBBdXRob3JpdHkwHhcNMDcwNDAzMTI1
// SIG // MzA5WhcNMjEwNDAzMTMwMzA5WjB3MQswCQYDVQQGEwJV
// SIG // UzETMBEGA1UECBMKV2FzaGluZ3RvbjEQMA4GA1UEBxMH
// SIG // UmVkbW9uZDEeMBwGA1UEChMVTWljcm9zb2Z0IENvcnBv
// SIG // cmF0aW9uMSEwHwYDVQQDExhNaWNyb3NvZnQgVGltZS1T
// SIG // dGFtcCBQQ0EwggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAw
// SIG // ggEKAoIBAQCfoWyx39tIkip8ay4Z4b3i48WZUSNQrc7d
// SIG // GE4kD+7Rp9FMrXQwIBHrB9VUlRVJlBtCkq6YXDAm2gBr
// SIG // 6Hu97IkHD/cOBJjwicwfyzMkh53y9GccLPx754gd6udO
// SIG // o6HBI1PKjfpFzwnQXq/QsEIEovmmbJNn1yjcRlOwhtDl
// SIG // KEYuJ6yGT1VSDOQDLPtqkJAwbofzWTCd+n7Wl7PoIZd+
// SIG // +NIT8wi3U21StEWQn0gASkdmEScpZqiX5NMGgUqi+YSn
// SIG // EUcUCYKfhO1VeP4Bmh1QCIUAEDBG7bfeI0a7xC1Un68e
// SIG // eEExd8yb3zuDk6FhArUdDbH895uyAc4iS1T/+QXDwiAL
// SIG // AgMBAAGjggGrMIIBpzAPBgNVHRMBAf8EBTADAQH/MB0G
// SIG // A1UdDgQWBBQjNPjZUkZwCu1A+3b7syuwwzWzDzALBgNV
// SIG // HQ8EBAMCAYYwEAYJKwYBBAGCNxUBBAMCAQAwgZgGA1Ud
// SIG // IwSBkDCBjYAUDqyCYEBWJ5flJRP8KuEKU5VZ5KShY6Rh
// SIG // MF8xEzARBgoJkiaJk/IsZAEZFgNjb20xGTAXBgoJkiaJ
// SIG // k/IsZAEZFgltaWNyb3NvZnQxLTArBgNVBAMTJE1pY3Jv
// SIG // c29mdCBSb290IENlcnRpZmljYXRlIEF1dGhvcml0eYIQ
// SIG // ea0WoUqgpa1Mc1j0BxMuZTBQBgNVHR8ESTBHMEWgQ6BB
// SIG // hj9odHRwOi8vY3JsLm1pY3Jvc29mdC5jb20vcGtpL2Ny
// SIG // bC9wcm9kdWN0cy9taWNyb3NvZnRyb290Y2VydC5jcmww
// SIG // VAYIKwYBBQUHAQEESDBGMEQGCCsGAQUFBzAChjhodHRw
// SIG // Oi8vd3d3Lm1pY3Jvc29mdC5jb20vcGtpL2NlcnRzL01p
// SIG // Y3Jvc29mdFJvb3RDZXJ0LmNydDATBgNVHSUEDDAKBggr
// SIG // BgEFBQcDCDANBgkqhkiG9w0BAQUFAAOCAgEAEJeKw1wD
// SIG // RDbd6bStd9vOeVFNAbEudHFbbQwTq86+e4+4LtQSooxt
// SIG // YrhXAstOIBNQmd16QOJXu69YmhzhHQGGrLt48ovQ7DsB
// SIG // 7uK+jwoFyI1I4vBTFd1Pq5Lk541q1YDB5pTyBi+FA+mR
// SIG // KiQicPv2/OR4mS4N9wficLwYTp2OawpylbihOZxnLcVR
// SIG // DupiXD8WmIsgP+IHGjL5zDFKdjE9K3ILyOpwPf+FChPf
// SIG // wgphjvDXuBfrTot/xTUrXqO/67x9C0J71FNyIe4wyrt4
// SIG // ZVxbARcKFA7S2hSY9Ty5ZlizLS/n+YWGzFFW6J1wlGys
// SIG // OUzU9nm/qhh6YinvopspNAZ3GmLJPR5tH4LwC8csu89D
// SIG // s+X57H2146SodDW4TsVxIxImdgs8UoxxWkZDFLyzs7BN
// SIG // Z8ifQv+AeSGAnhUwZuhCEl4ayJ4iIdBD6Svpu/RIzCzU
// SIG // 2DKATCYqSCRfWupW76bemZ3KOm+9gSd0BhHudiG/m4LB
// SIG // J1S2sWo9iaF2YbRuoROmv6pH8BJv/YoybLL+31HIjCPJ
// SIG // Zr2dHYcSZAI9La9Zj7jkIeW1sMpjtHhUBdRBLlCslLCl
// SIG // eKuzoJZ1GtmShxN1Ii8yqAhuoFuMJb+g74TKIdbrHk/J
// SIG // mu5J4PcBZW+JC33Iacjmbuqnl84xKf8OxVtc2E0bodj6
// SIG // L54/LlUWa8kTo/0xggSDMIIEfwIBATCBkDB5MQswCQYD
// SIG // VQQGEwJVUzETMBEGA1UECBMKV2FzaGluZ3RvbjEQMA4G
// SIG // A1UEBxMHUmVkbW9uZDEeMBwGA1UEChMVTWljcm9zb2Z0
// SIG // IENvcnBvcmF0aW9uMSMwIQYDVQQDExpNaWNyb3NvZnQg
// SIG // Q29kZSBTaWduaW5nIFBDQQITMwAAALARrwqL0Duf3QAB
// SIG // AAAAsDAJBgUrDgMCGgUAoIGcMBkGCSqGSIb3DQEJAzEM
// SIG // BgorBgEEAYI3AgEEMBwGCisGAQQBgjcCAQsxDjAMBgor
// SIG // BgEEAYI3AgEVMCMGCSqGSIb3DQEJBDEWBBQglR23kfZX
// SIG // nqVlXUIt7yVQdqCI/zA8BgorBgEEAYI3AgEMMS4wLKAM
// SIG // gAoAYQBkAC4AagBzoRyAGmh0dHA6Ly93d3cubWljcm9z
// SIG // b2Z0LmNvbS8gMA0GCSqGSIb3DQEBAQUABIIBAN8DJXGB
// SIG // nq0fSBIu61fTNsKbGufMW1reiH/i6NcBo9l/MaDVCojk
// SIG // fnpDomJSTMKghYRWAQA8BXQ3csO6UK65W28TYbmlhx15
// SIG // VSnY4Vfc9ogvwrSGMY5YOLOm6OwYyTbgjjKvd4OKc/VC
// SIG // UUwlxRpY0ryHgQo9XWQEDgD/W8sn43HXwFv3d56cxqMh
// SIG // xoHsVSc+nwKVIzAEdSO6LxwYcLXcK6bERDM5dTGifOAB
// SIG // QnWEsJKjm++lB6Zizzp0R1DC5oI3Xki26o/t5VMFPeoE
// SIG // nk9Aa9WoXOJB0rNj/vY0TdJHxxrFJqn5+uJvMV1UgxZz
// SIG // jFWHfpwHGd44KoqvB46m2nt/iDmhggIoMIICJAYJKoZI
// SIG // hvcNAQkGMYICFTCCAhECAQEwgY4wdzELMAkGA1UEBhMC
// SIG // VVMxEzARBgNVBAgTCldhc2hpbmd0b24xEDAOBgNVBAcT
// SIG // B1JlZG1vbmQxHjAcBgNVBAoTFU1pY3Jvc29mdCBDb3Jw
// SIG // b3JhdGlvbjEhMB8GA1UEAxMYTWljcm9zb2Z0IFRpbWUt
// SIG // U3RhbXAgUENBAhMzAAAAM+UnhqMOSiqAAAAAAAAzMAkG
// SIG // BSsOAwIaBQCgXTAYBgkqhkiG9w0BCQMxCwYJKoZIhvcN
// SIG // AQcBMBwGCSqGSIb3DQEJBTEPFw0xMzA5MTMxODQ3NTda
// SIG // MCMGCSqGSIb3DQEJBDEWBBQkz3kwwkwHlW3YvrMD7S1y
// SIG // qhmQ4TANBgkqhkiG9w0BAQUFAASCAQBZfpt66FtPK58V
// SIG // QHbE0j5TQUKkpgKHZ1PUPn/M4e7CY06P39w0gMepOEMH
// SIG // vnQRN3uDF4pg0rze4aWDwoXHRQnnss/wh5TB6FAHz/yK
// SIG // mkOM0lC2gGSR9tvlVUgoAEuOTPKAAC/L/99cpK0o4ril
// SIG // 5I8GZy8YTai0Mhy2XsF2/BKLYaLH2AjciFTmrC/fC7d5
// SIG // jhCeLPVpPj6I2ptLNeov8x/xxQECh+1siCZXUo0+/YBl
// SIG // H+9rXDYDYwkH24EGmUqIOPYXev6jOkeSubxcl/giob26
// SIG // KVIkHWnmLseREvVOmBsKwD27cz0EznMPkEzg0Hg8ilEt
// SIG // 3RIhMmo1GLsfhZdkY13H
// SIG // End signature block
